<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tauschb√∂rse - PR√ÑSENTATIONS MODUS</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; padding: 20px; background: #f4f4f4; color: #333; text-align: center; margin-bottom: 80px; }
        .card { background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: left; }
        .logo-container { margin-bottom: 0px; }
h2 { margin-top: 0px; font-weight: 800; }
        .logo-img { max-width: 100%; height: auto; max-height: 80px; }
        h2 { color: #1a237e; font-size: 28px; font-weight: 900; text-transform: uppercase; border-bottom: 2px solid #1a237e; display: inline-block; padding-bottom: 5px; margin-bottom: 20px; }
        
        input, textarea, button, select { padding: 12px; margin: 8px 0; width: 100%; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc; font-size: 16px; }
        button { background: #007bff; color: white; border: none; cursor: pointer; font-weight: bold; }
        .contact-btn-inner { background: #28a745; margin-top: 10px; display: block; text-decoration: none; color: white; padding: 12px; border-radius: 4px; text-align: center; font-weight: bold; }
        .edit-btn { background: #6c757d; margin-top: 10px; flex: 1; }
        .delete-btn { background: #ff9800; margin-top: 10px; flex: 1; }
        .logout-btn { background: #dc3545; padding: 8px; font-size: 14px; width: auto; }
        .hidden { display: none !important; }
        .warning-box { background: #fff3cd; color: #856404; padding: 15px; border-radius: 8px; border: 1px solid #ffeeba; margin-bottom: 15px; }
        .item-img { width: 100%; border-radius: 5px; margin: 10px 0; max-height: 300px; object-fit: cover; }
        
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; color: white; display: inline-block; margin-bottom: 5px; }
        .badge-suche { background: #ff9800; }
        .badge-biete { background: #28a745; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 2000; padding: 15px; box-sizing: border-box; }
        .modal-content { background: white; width: 100%; max-width: 500px; padding: 25px; border-radius: 12px; max-height: 90vh; overflow-y: auto; text-align: left; position: relative; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .close-x { position: absolute; right: 15px; top: 10px; font-size: 32px; cursor: pointer; color: #999; line-height: 1; padding: 5px; }

        .site-footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ccc; font-size: 12px; color: #666; }
        .footer-links { margin-top: 10px; }
        .footer-links a { color: #007bff; text-decoration: none; margin: 0 10px; cursor: pointer; }
        .legal-notice { font-size: 11px; color: #888; font-style: italic; margin-bottom: 15px; }
    </style>
</head>
<body>

    <div class="logo-container">
        <a href="https://www.wegweiser-betreuungsdienst.de/" target="_blank">
            <img src="./logo.png" alt="Logo" class="logo-img">
        </a>
    </div>

    <h2>Tauschb√∂rse</h2>
    <p class="legal-notice">Kostenlose Nachbarschaftshilfe. <br>Haftung f√ºr getauschte Gegenst√§nde ist ausgeschlossen.</p>

    <div id="login-area" class="card">
        <div id="auth-login">
            <h3>Anmelden (Demo)</h3>
            <input type="email" id="email" placeholder="E-Mail" value="test@user.de">
            <input type="password" id="pass" placeholder="Passwort" value="passwort">
            <button onclick="demoLogin('Demo User')">Anmelden</button>
            <p><a onclick="toggleAuth('register')" style="cursor:pointer; color:#007bff">Neues Konto erstellen</a></p>
        </div>

        <div id="auth-register" class="hidden">
            <h3>Registrieren (Demo)</h3>
            <input type="text" id="reg-user" placeholder="Nutzername">
            <input type="email" id="reg-email" placeholder="E-Mail">
            <input type="password" id="reg-pass" placeholder="Passwort">
            <input type="password" id="reg-pass-confirm" placeholder="Wiederholen">
            <button onclick="demoRegister()" style="background:#28a745">Konto erstellen</button>
            <p><a onclick="toggleAuth('login')" style="cursor:pointer; color:#007bff">Zur√ºck zum Login</a></p>
        </div>
    </div>

    <div id="main-area" class="hidden">
        <div class="card" style="display: flex; justify-content: space-between; align-items: center;">
            <span>Hallo, <b id="username-display">...</b></span>
            <button onclick="location.reload()" class="logout-btn">Abmelden</button>
        </div>

        <button id="show-form-btn" onclick="openForm()">+ Neuen Eintrag (Suche/Biete)</button>
        <div id="artikel-liste"></div>
    </div>

    <div id="modal-container" class="modal-overlay hidden" onclick="if(event.target.id==='modal-container')closeForm()">
        <div class="modal-content">
            <span class="close-x" onclick="closeForm()">&times;</span>
            <h3 id="form-title">Neuer Eintrag</h3>
            <input type="hidden" id="edit-id">
            
            <label for="typ" style="font-size: 13px; font-weight: bold;">Art des Eintrags:</label>
            <select id="typ">
                <option value="biete">Ich biete etwas an</option>
                <option value="suche">Ich suche etwas</option>
            </select>

            <input type="text" id="title" placeholder="Titel">
            <input type="text" id="standort" placeholder="Stadtteil">
            <textarea id="beschreibung" placeholder="Beschreibung" rows="4"></textarea>
            
            <p style="font-size: 13px; font-weight: bold; margin: 10px 0 0 0;">Foto:</p>
            <p style="font-size: 11px; color: #666; margin-bottom: 5px;">(Pflicht bei Angeboten)</p>
            <input type="file" id="foto" accept="image/*">
            
            <button onclick="artikelSpeichern()" id="save-btn" style="background:#28a745; margin-top: 15px;">Speichern</button>
        </div>
    </div>

    <div id="legal-modal" class="modal-overlay hidden" onclick="if(event.target.id==='legal-modal')closeLegal()">
        <div class="modal-content">
            <span class="close-x" onclick="closeLegal()">&times;</span>
            <h3 id="legal-title">Information</h3>
            <div id="legal-body"></div>
        </div>
    </div>

    <footer class="site-footer">
        <div>&copy; 2026 Wegweiser Betreuungsdienst</div>
        <div class="footer-links">
            <a onclick="showLegal('impressum')">Impressum</a> | 
            <a onclick="showLegal('datenschutz')">Datenschutz</a> | 
            <a onclick="showLegal('disclaimer')">Disclaimer</a>
        </div>
    </footer>

    <script>
        // --- DEMO DATEN ---
        let currentUserName = "";
        let demoArtikel = [
            { id: '1', typ: 'biete', title: 'Fahrrad 26 Zoll', standort: 'Mitte', beschreibung: 'Gebrauchtes Mountainbike zu verschenken.', user: 'Max', created: new Date(), foto: 'https://images.unsplash.com/photo-1485965120184-e220f721d03e?w=300' },
            { id: '2', typ: 'suche', title: 'Suche Hilfe beim Einkauf', standort: 'Nord', beschreibung: 'Wer kann mir 1x die Woche helfen?', user: 'Anna', created: new Date(), foto: null },
            { id: '3', typ: 'biete', title: 'Kaffeemaschine', standort: 'West', beschreibung: 'Voll funktionsf√§hig, wird nicht mehr gebraucht.', user: 'Demo User', created: new Date(), foto: 'https://images.unsplash.com/photo-1517668808822-9ebb02f2a0e6?w=300' }
        ];

        // --- AUTH LOGIK ---
        function toggleAuth(mode) {
            document.getElementById('auth-login').classList.toggle('hidden', mode === 'register');
            document.getElementById('auth-register').classList.toggle('hidden', mode === 'login');
        }

        function demoLogin(name) {
            currentUserName = name || "Demo Nutzer";
            document.getElementById('login-area').classList.add('hidden');
            document.getElementById('main-area').classList.remove('hidden');
            document.getElementById('username-display').innerText = currentUserName;
            ladeArtikel();
        }

        function demoRegister() {
            const name = document.getElementById('reg-user').value;
            if(!name) return alert("Name angeben");
            demoLogin(name);
        }

        // --- ARTIKEL LOGIK ---
        function ladeArtikel() {
            const liste = document.getElementById('artikel-liste');
            liste.innerHTML = demoArtikel.map(item => `
                <div class="card" style="border-top: 4px solid ${item.typ === 'suche' ? '#ff9800' : '#28a745'}">
                    <span class="badge ${item.typ === 'suche' ? 'badge-suche' : 'badge-biete'}">${item.typ.toUpperCase()}</span>
                    ${item.foto ? `<img src="${item.foto}" class="item-img">` : ''}
                    <h4>${item.title}</h4>
                    <p>${item.beschreibung}</p>
                    <div style="font-size: 13px; color: #666; border-top: 1px solid #eee; padding-top: 8px; margin-top: 10px;">
                        Von: <b>${item.user}</b> | üìç Ort: <b>${item.standort}</b>
                    </div>
                    <button class="contact-btn-inner" onclick="alert('Kontaktanfrage an ${item.user} gesendet!')">üìß Kontaktieren</button>
                    ${item.user === currentUserName ? `
                        <div style="display:flex; gap:10px">
                            <button class="edit-btn" onclick='openForm(${JSON.stringify(item)})'>‚úèÔ∏è</button>
                            <button class="delete-btn" onclick="loescheArtikel('${item.id}')">üóëÔ∏è</button>
                        </div>` : ''}
                </div>
            `).join('');
        }

        async function artikelSpeichern() {
            const typ = document.getElementById('typ').value;
            const fileInput = document.getElementById('foto');
            const editId = document.getElementById('edit-id').value;

            if (typ === 'biete' && !editId && !fileInput.files[0]) {
                return alert("Bitte ein Foto hochladen.");
            }

            let finalFoto = null;
            if(fileInput.files[0]) {
                finalFoto = await new Promise(r => {
                    const reader = new FileReader();
                    reader.onload = e => r(e.target.result);
                    reader.readAsDataURL(fileInput.files[0]);
                });
            }

            if (editId) {
                const idx = demoArtikel.findIndex(a => a.id === editId);
                demoArtikel[idx] = { ...demoArtikel[idx], 
                    title: document.getElementById('title').value,
                    standort: document.getElementById('standort').value,
                    beschreibung: document.getElementById('beschreibung').value,
                    typ: typ,
                    foto: finalFoto || demoArtikel[idx].foto
                };
            } else {
                demoArtikel.unshift({
                    id: Date.now().toString(),
                    typ, title: document.getElementById('title').value,
                    standort: document.getElementById('standort').value,
                    beschreibung: document.getElementById('beschreibung').value,
                    user: currentUserName, foto: finalFoto
                });
            }
            closeForm();
            ladeArtikel();
        }

        function loescheArtikel(id) {
            demoArtikel = demoArtikel.filter(a => a.id !== id);
            ladeArtikel();
        }

        function openForm(editData = null) {
            document.getElementById('modal-container').classList.remove('hidden');
            if (editData) {
                document.getElementById('edit-id').value = editData.id;
                document.getElementById('title').value = editData.title;
                document.getElementById('standort').value = editData.standort;
                document.getElementById('beschreibung').value = editData.beschreibung;
                document.getElementById('typ').value = editData.typ;
            } else {
                document.getElementById('edit-id').value = "";
                document.getElementById('title').value = "";
                document.getElementById('standort').value = "";
                document.getElementById('beschreibung').value = "";
            }
        }

        function closeForm() { document.getElementById('modal-container').classList.add('hidden'); }

        // --- LEGAL TEXTS ---
        const legalTexts = {
            impressum: `<h3>Impressum</h3>
                        <p><b>Wegweiser Betreuungsdienst</b><br>
                        Detlev Sch√ºrmann<br>
                        Kurf√ºrstenstr. 8<br>
                        47906 Kempen</p>
                        <p><b>Kontakt:</b><br>
                        E-Mail: info@wegweiser-betreuungsdienst.de<br>
                        Telefon: +49 2152 99454-0<br>
                        Telfax: +49 2152 99454-19</p>`,
    
            datenschutz: `<h3>Datenschutz</h3>
                          <p>Diese Plattform dient dem Austausch von Gegenst√§nden unter Nachbarn. Wir erheben und speichern nur die Daten, die zur Nutzung notwendig sind (Nutzername, E-Mail-Adresse und die von Ihnen erstellten Anzeigen). </p>
                          <p>Ihre E-Mail-Adresse wird anderen registrierten Nutzern nur zum Zweck der Kontaktaufnahme angezeigt. Wir geben keine Daten an unbefugte Dritte weiter.</p>`,
    
            disclaimer: `<h3>Haftungsausschluss (Disclaimer)</h3>
                         <p><b>1. Inhalt des Onlineangebotes</b><br>
                         Der Wegweiser Betreuungsdienst stellt lediglich die technische Plattform f√ºr den privaten Austausch zur Verf√ºgung. Wir treten nicht als Vertragspartner der Tauschgesch√§fte auf.</p>
                 
                         <p><b>2. Haftungsausschluss f√ºr Tauschgegenst√§nde</b><br>
                 Der Tausch erfolgt rein privat und unter Ausschluss jeglicher Gew√§hrleistung oder Garantie. Wir pr√ºfen die angebotenen Gegenst√§nde nicht auf Zustand, Funktion oder Sicherheit. Die Nutzung der getauschten Gegenst√§nde erfolgt auf eigene Gefahr.</p>
                 
                         <p><b>3. Haftungsbegrenzung</b><br>
                         Die Haftung des Betreibers f√ºr Sach- oder Verm√∂genssch√§den, die durch die Nutzung der Plattform oder durch getauschte Gegenst√§nde entstehen, ist ausgeschlossen, sofern kein vors√§tzliches oder grob fahrl√§ssiges Handeln vorliegt. Haftung f√ºr Sch√§den aus der Verletzung des Lebens, des K√∂rpers oder der Gesundheit bleibt unber√ºhrt.</p>`
        };

        function showLegal(type) {
            document.getElementById('legal-body').innerHTML = legalTexts[type];
            document.getElementById('legal-modal').classList.remove('hidden');
        }

        function closeLegal() { document.getElementById('legal-modal').classList.add('hidden'); }
    </script>
</body>
</html>
